<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <title>Yii 2 - How to make internationalization (multilanguage) | Atoumus Blog</title> <link rel="alternate" href="http://atoumus.github.io/yii2-i18n.html" hreflang="ru" /> <link rel="alternate" href="http://atoumus.github.io/en/yii2-i18n.html" hreflang="en" /> <link rel="alternate" type="application/atom+xml" title="Atoumus Blog" href="/en/atom.xml" /> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" type="text/css" href="/css/libs/flaticon/flaticon.css"> <link rel="stylesheet" type="text/css" href="/css/libs/prism.css"> <link rel="stylesheet" type="text/css" href="/css/libs/prism-fix.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css" /> <link rel="stylesheet" type="text/css" href="/css/common.css"> </head> <body> <a href="#top" class="elevator"><span class="flaticon-upwards-arrow"></span></a> <a name="top"></a> <div class="main"> <div class="header"> <a href="/en/" class="logo" title="Atoumus Blog" ><img src="/images/logo.png">Atoumus Blog</a> <form class="search" action="//google.com/search" target="_blank" method="get" accept-charset="UTF-8"> <input type="search" name="q" class="search-input"> <button type="submit">Search</button> <input type="hidden" name="sitesearch" value="http://atoumus.github.io"> </form> <div class="social"> <a href="#" class="search-toggle flaticon-magnifier" title="Search"></a> <a href="/en/atom.xml" target="_blank" class="flaticon-rss-feed-button" title="Atom feed"></a> <a href="https://twitter.com/atoumus/" target="_blank" class="flaticon-twitter-logo-silhouette" title="Twitter"></a> <a href="https://plus.google.com/u/0/116624784918762784912" target="_blank" class="flaticon-google-plus-logo-button" title="G+"></a> </div> </div> <div class="clear-both"></div> <div class="menu"> <div class="tags"> <a href='/en/'>Home</a><a href='/en/tag/Yii/' class='selected'>Yii</a><a href='/en/tag/VirtualBox/'>VirtualBox</a><a href='/en/tag/Vagrant/'>Vagrant</a> </div> <div class="lang-switcher"> <a href='/yii2-i18n.html'>ru</a><span>en</span> </div> </div> <div class="clear-both"></div> <div class="contents"> <div class="article"> <h1>Yii 2 - How to make internationalization (multilanguage)</h1> <div class="meta"> <div> <span class="flaticon-calendar-with-spring-binder-and-date-blocks"></span> 2016-08-12 </div> <div> <span class="flaticon-commerce"></span> <a href='/en/tag/Yii/'>Yii</a> </div> <div class="comments-number"> <span class="flaticon-comment-white-oval-bubble"></span> <a href="#comments" data-disqus-url="http://atoumus.github.io/en/yii2-i18n.html"></a> </div> </div> <div class="clear-both"></div> <div class="text"><p>Consider the example of the internationalization of the site in Yii 2 in two languages: &quot;de&quot; and &quot;en&quot;.</p> <p>Yii 2 already have built-in component for make internationalization, it is called <code>i18n</code>. In order that you could start using it, it's enough to add it to the configuration of the application in the <code>components</code> section. Also, for the full operation of this component, requires a PHP extension <a target="_blank" href="http://www.php.net/manual/en/intro.intl.php">intl</a>.</p> <p>In this article, we will consider an example of the internationalization of a site in Yii 2 in two languages: &quot;de&quot; and &quot;en&quot;.</p> <p>There are two variants of language identifiers:</p> <ul> <li>abbreviated, for example: &quot;de&quot;, &quot;en&quot;;</li> <li>full, for example: &quot;de-DE&quot;, &quot;en-US&quot;.</li> </ul> <p>We will use the abbreviated version (&quot;de&quot; and &quot;en&quot;), since it is quite enough for the required functionality and it is more concisely perceived visually.</p> <p>As a code base, you can use any site on Yii 2, or the basic application template provided by the framework. How to install the basic application template, you can read in this <a target="_blank" href="/en/yii2-basic-advanced.html">article</a>.</p> <h2>Goals</h2> <p>Goals, which is necessary to achieve:</p> <ul> <li>site switching between two languages: &quot;de&quot; and &quot;en&quot;;</li> <li>display the language in the address bar in the form <code>http://site.com/en/</code>;</li> <li>automatic redirection of the user to the language most suitable for him, if he moved to the site without specifying a language;</li> <li>storage of translations should be in PHP files in the arrays;</li> <li>translations of static pages should be contained in separate view scripts for different languages.</li> </ul> <h2>Configuration</h2> <p>We begin the implementation with the writing configurations in the file <code>\config\web.php</code>:</p> <pre class="line-numbers"><code class="language-php">[
    ...
    'sourceLanguage' =&gt; 'en',
    'language' =&gt; 'en',
    ...
    'components' =&gt; [
        ...
        'urlManager' =&gt; [
            'enablePrettyUrl' =&gt; true,
            'showScriptName' =&gt; false,
            'rules' =&gt; [
            ],
        ],
        ...
        'i18n' =&gt; [
            'translations' =&gt; [
                'common*' =&gt; [
                    'class' =&gt; 'yii\i18n\PhpMessageSource',
                    'basePath' =&gt; '@app/messages',
                ],
            ],
        ],
        ...
    ]
]</code></pre> <p>In this configuration:</p> <p><code>sourceLanguage</code> - is the source language of messages, i.e. the one that will be used as the translation keys, in this case <code>en</code>.</p> <p><code>language</code> - is the default language to which the user will be redirected if it is not possible to determine for him, the most appropriate language based on the data provided by his browser.</p> <p><code>components -&gt; urlManager</code> - in this section we enable the &quot;pretty URLs&quot;, for a more visual display of URLs.</p> <p><code>components -&gt; i18n</code> - this section is intended for configuring the internationalization component. The key of the array <code>common*</code> - means the category to which the translations from the corresponding <code>common.php</code> file will apply. The category name can be specified and any other, or for example make several categories, but for an example we'll manage one. In the section <code>'class' =&gt; 'yii\i18n\PhpMessageSource'</code> it is necessary to specify exactly how we will store messages, in this case it is indicated that in the PHP files (in the associative arrays). In addition to <code>yii\i18n\PhpMessageSource</code>, there are other options, for example, messages can be stored in a database. In the section <code>'basePath' =&gt; '@app/messages'</code> there is a path to which PHP files with translations will be located.</p> <h2>File with translations list</h2> <p>Now you need to create a PHP file that will contain an associative array with translations.</p> <p>When configuring the <code>i18n</code> component, we specified:</p> <pre class="line-numbers"><code class="language-php">...
'translations' =&gt; [
    'common*' =&gt; [
        'class' =&gt; 'yii\i18n\PhpMessageSource',
        'basePath' =&gt; '@app/messages',
    ],
],
...</code></pre> <p>This means that the translation file must have the same name as the category name, i.e. <code>common.php</code>. It should be stored in this path <code>\messages\de\common.php</code>.</p> <p>For our example with two languages (&quot;de&quot; and &quot;en&quot;), it is enough to create one file with translations only for the German language, since English translations will be in the form of keys for all other translations. I.e. everywhere on the site will be English messages, and when switching to German, the framework will replace them with the German ones.</p> <p>For example, if we wanted to add some additional language, for example &quot;fr&quot;, then in addition to the file <code>\messages\de\common.php</code> we will be need to create a similar for the French language <code>\messages\fr\common.php</code>. But in our example there will be only one file <code>\messages\de\common.php</code>, create it, while with an empty array:</p> <pre class="line-numbers"><code class="language-php">&lt;?php

return [];</code></pre> <h2>Adding translations</h2> <p>Now you need to add translations in the site code and also add them to the file <code>\messages\de\common.php</code>.</p> <p>To output translations in Yii 2, there is a special method <code>Yii::t()</code>. Example of use:</p> <pre><code class="language-php">&lt;?= Yii::t('common', 'Example text...') ?&gt;</code></pre> <p>In the first argument, we specify the category, we have one - <code>common</code>. In the second argument, we write English text as it should display on the site.</p> <p>After this, you need to add the German translation to the file <code>\messages\de\common.php</code>:</p> <pre class="line-numbers"><code class="language-php">return [
    ...
    'Example text...' =&gt; 'Beispiel text...',
    ...
];</code></pre> <p>We use English translation as a key, and German as the value.</p> <p>It is necessary to perform such actions throughout the code, i.e. all the texts displayed are to be replaced by English, and output them with the <code>Yii::t()</code> method. And also add German translations for all English texts to the file <code>\messages\de\common.php</code>.</p> <h2>Switching languages</h2> <p>The user should be able to switch between languages. To do this, you need to display links for switching site to German or English languages. For this we will create a special view script <code>\views\layouts\main\select-language.php</code>:</p> <pre class="line-numbers"><code class="language-php">&lt;?php

use yii\bootstrap\Html;

if(\Yii::$app-&gt;language == 'de'):
    echo Html::a('Go to English', array_merge(
        \Yii::$app-&gt;request-&gt;get(),
        [\Yii::$app-&gt;controller-&gt;route, 'language' =&gt; 'en']
    ));
else:
    echo Html::a('Wechseln zu Deutsch', array_merge(
        \Yii::$app-&gt;request-&gt;get(),
        [\Yii::$app-&gt;controller-&gt;route, 'language' =&gt; 'de']
    ));
endif;</code></pre> <p>Next, you need to render this view script in the main view script <code>\views\layouts\main.php</code>, for this, the following line:</p> <pre><code class="language-php">&lt;p class="pull-left"&gt;&amp;copy; My Company &lt;?= date('Y') ?&gt;&lt;/p&gt;</code></pre> <p>should be replaced by:</p> <pre><code class="language-php">&lt;p class="pull-left"&gt;&amp;copy; My Company &lt;?= date('Y') ?&gt; | &lt;?= $this-&gt;render('main/select-language') ?&gt;&lt;/p&gt;</code></pre> <p>In this line, we added the rendering of the view script to switching languages, with the help of it, in the footer, a link will be displayed for switching to another language.</p> <h2>Using an external UrlManager</h2> <p>Now we need to make display the current language in the address bar, for example <code>http://site.com/en</code>. Unfortunately, Yii 2 does not provide any built-in capabilities for this, and even to do this by some adequate roundabout ways does not work out, or at very difficult. The most &quot;correct&quot; way out in this situation is to override the standard class <code>yii\web\UrlManager</code> on your own, in which some methods will be replaced. These replaced methods must take on the implementation of the language displaying in the address bar.</p> <p>In general, the replacement of standard classes of the framework for third-party ones, personally in my opinion it is a hardcode. But apparently in the Yii 2 framework it is unfortunately a normal practice.</p> <p>We will not write our own implementation of the class &quot;UrlManager&quot;, since this &quot;bicycle&quot; has already been created and it can simply be required via Composer, which we will do. Go to the console in the project's root folder, and execute the command (here it means that Composer is installed globally):</p> <pre><code class="language-bash">$ composer require codemix/yii2-localeurls</code></pre> <p>The <code>codemix/yii2-localeurls</code> package gives us the following options:</p> <ul> <li>display the current language in the address bar;</li> <li>redirect the user to the most appropriate language for him based on the data sent by his browser. </li> </ul> <p>Next, we need to reconfigure the <code>urlManager</code> component, that he would not use the standard class of the framework, but just required. To do this, in the file <code>\config\web.php</code>, in the section <code>componets -&gt; urlManager</code> we add the following three lines:</p> <pre class="line-numbers"><code class="language-php">[
    ...
    'components' =&gt; [
        ...
        'urlManager' =&gt; [
            ...
            'class' =&gt; 'codemix\localeurls\UrlManager',
            'languages' =&gt; ['de', 'en'],
            'enableDefaultLanguageUrlCode' =&gt; true,
            ...
        ],
        ...
    ]
    ...
]</code></pre> <p>A few explanations for this configuration:</p> <p><code>'class' =&gt; 'codemix\localeurls\UrlManager'</code> - we specify the framework that instead of the standard class <code>UrlManager</code> the one that we just required via Composer was used.</p> <p><code>'languages' =&gt; ['de', 'en']</code> - in which languages the project is translated.</p> <p><code>'enableDefaultLanguageUrlCode' =&gt; true</code> - this flag means that we want the current language displayed in the address bar always, even if the user simply is on the main page (i.e. the address will be of the form <code>http://site.com/en</code>). If desired, this flag can also be omitted, by default it will be set to <code>false</code>, which means that on the main page the language in the address bar will not be displayed (i.e. the address will be of the form <code>http://site.com</code>).</p> <h2>Static pages internationalization</h2> <p>Yii 2 have a built-in class <code>\yii\web\ViewAction</code>, which is designed to implement static pages.</p> <p>But by default it does not support internationalization.</p> <p>The bottom line is that static pages have large text, which is not convenient to insert into translation files (i.e. in our case in the file <code>\messages\de\common.php</code>). Translations for static pages are best stored in separate files - in different view scripts which will correspond to different languages.</p> <p>We implement internationalized static pages, for this purpose in the file <code>\controllers\SiteController.php</code>, in the <code>actions()</code> method, add the following section:</p> <pre class="line-numbers"><code class="language-php">public function actions()
{
    return [
        ...
        'page' =&gt; [
            'class' =&gt; \yii\web\ViewAction::className(),
            'viewPrefix' =&gt; 'pages/' . \Yii::$app-&gt;language
        ]
        ...
    ];
}</code></pre> <p>This section contains the main code that allows to internationalize static pages, this is <code>'viewPrefix' =&gt; 'pages/' . \Yii::$app-&gt;language</code>. In the <code>viewPrefix</code> parameter, we specify on what path we will have view scripts for static pages, but in our case we also substitute in this path current language <code>\Yii::$app-&gt;language</code>.</p> <p>Next, create two view scripts that will correspond to one static page, but everyone will be for their language. For English <code>\views\site\pages\en\some.php</code> should contain the text: &quot;English static page...&quot;. For German <code>\views\site\pages\de\some.php</code> should contain the text: &quot;Deutsche statische Seite...&quot;.</p> <p>Now we will configure the &quot;pretty URLs&quot; for static pages, for this, in the config <code>\config\web.php</code> in the section <code>urlManager -&gt; rules</code> add the rule:</p> <pre class="line-numbers"><code class="language-php">'urlManager' =&gt; [
    ...
    'rules' =&gt; [
        'page/&lt;view:[a-zA-Z0-9-]+&gt;' =&gt; 'site/page',
    ],
    ...
],</code></pre> <p>On this, the implementation of static pages is finished, you can check, try to open two addresses in the browser:</p> <ul> <li><code>http://site.com/de/page/some</code> - a German static page will open;</li> <li><code>http://site.com/en/page/some</code> - an English static page will open;</li> </ul> <h2>Conclusion</h2> <p>In general, the implementation of internationalization in Yii 2 does not represent anything complicated, especially if you use the third-party component <code>codemix/yii2-localeurls</code>.</p> <p>The goals that were described at the beginning of the article are fully implemented:</p> <ul> <li>the site switching between the two languages takes place by link which is located in the footer;</li> <li>the current language is displayed in the address bar in the form <code>http://site.com/en/</code>;</li> <li>if the user went to the site without specifying the language (i.e. <code>http://site.com</code>), then it will be redirected to the most appropriate language for it (e.g. <code>http://site.com/en</code>);</li> <li>translations is stored in PHP files in the associative arrays;</li> <li>translations of static pages are stored in separate view scripts for different languages.</li> </ul></div> <div class="related"> <h2>Read also</h2> <a href="/en/yii2-swiftmailer.html" target="_blank" >Yii 2 - Sending emails using Swiftmailer</a> <a href="/en/yii2-flash-messages.html" target="_blank" >Yii 2 - Displaying flash (users) messages on the site</a> <a href="/en/yii2-basic-advanced.html" target="_blank" >Yii 2 - Installation basic and advanced application templates via Composer</a> </div> <div class="share">Share: <script type="text/javascript">(function () { if (window.pluso) if (typeof window.pluso.start == "function") return; if (window.ifpluso == undefined) { window.ifpluso = 1; var d = document, s = d.createElement('script'), g = 'getElementsByTagName'; s.type = 'text/javascript'; s.charset = 'UTF-8'; s.async = true; s.src = ('https:' == window.location.protocol ? 'https' : 'http') + '://share.pluso.ru/pluso-like.js'; var h = d[g]('body')[0]; h.appendChild(s); } })();</script> <div class="pluso" data-background="transparent" data-options="small,round,line,horizontal,counter,theme=04" data-services="vkontakte,odnoklassniki,facebook,twitter,google,moimir,email,print"></div></div>   <div class="comments"> <a name="comments"></a> <div id="disqus_thread"></div> <script> var disqus_config = function () { this.page.url = "http://atoumus.github.io/en/yii2-i18n.html"; this.language = "en"; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://atoumus.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </div> </div> <div class="footer"> <div class="left"> <div class="social"> <a href="#" class="icon search-toggle flaticon-magnifier" title="Search"></a> <a href="/en/atom.xml" target="_blank" class="icon flaticon-rss-feed-button" title="Atom feed"></a> <a href="https://twitter.com/atoumus/" target="_blank" class="icon flaticon-twitter-logo-silhouette" title="Twitter"></a> <a href="https://plus.google.com/u/0/116624784918762784912" target="_blank" class="icon flaticon-google-plus-logo-button" title="G+"></a> </div> <div class="author-email"> <a data-email-array='{"13":".","6":"s","16":"m","9":"m","12":"l","8":"g","5":"u","1":"t","7":"@","11":"i","4":"m","2":"o","0":"a","10":"a","3":"u","14":"c","15":"o"}' href="#"></a> </div> <div class="donate"> <a href="https://money.yandex.ru/to/410015801161863" target="_blank">Donate</a> </div> </div> <div class="right"> <div>  <script type="text/javascript"> document.write("<a href='//www.liveinternet.ru/click' "+ "target=_blank><img src='//counter.yadro.ru/hit?t25.5;r"+ escape(document.referrer)+((typeof(screen)=="undefined")?"": ";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth? screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+ ";"+Math.random()+ "' alt='' title='LiveInternet: показано число посетителей за"+ " сегодня' "+ "border='0' width='88' height='15'><\/a>") </script>  </div> <div> Atoumus Blog &copy; 2011 - 2018 </div> <div> Copy and citation with necessarily URL link to original page </div> </div> </div> <div class="clear-both"></div> </div> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script> <script type="text/javascript" src="/js/libs/prism.js"></script> <script type="text/javascript" src="/js/common.js"></script> </body> </html>