<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <title>Yii2 - Отображение флеш (пользовательских) сообщений на сайте | Atoumus Blog</title> <link rel="alternate" href="http://atoumus.github.io/yii2-flash-messages.html" hreflang="ru" /> <link rel="alternate" href="http://atoumus.github.io/en/" hreflang="en" /> <link rel="alternate" type="application/atom+xml" title="Atoumus Blog" href="/atom.xml" /> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" type="text/css" href="/css/libs/flaticon/flaticon.css"> <link rel="stylesheet" type="text/css" href="/css/libs/prism.css"> <link rel="stylesheet" type="text/css" href="/css/libs/prism-fix.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css" /> <link rel="stylesheet" type="text/css" href="/css/common.css"> </head> <body> <a href="#top" class="elevator"><span class="flaticon-upwards-arrow"></span></a> <a name="top"></a> <div class="main"> <div class="header"> <a href="/" class="logo" title="Atoumus Blog" ><img src="/images/logo.png">Atoumus Blog</a> <form class="search" action="//google.com/search" target="_blank" method="get" accept-charset="UTF-8"> <input type="search" name="q" class="search-input"> <button type="submit">Поиск</button> <input type="hidden" name="sitesearch" value="http://atoumus.github.io"> </form> <div class="social"> <a href="#" class="search-toggle flaticon-magnifier" title="Поиск"></a> <a href="/atom.xml" target="_blank" class="flaticon-rss-feed-button" title="Atom лента"></a> <a href="https://twitter.com/atoumus/" target="_blank" class="flaticon-twitter-logo-silhouette" title="Twitter"></a> <a href="https://plus.google.com/u/0/116624784918762784912" target="_blank" class="flaticon-google-plus-logo-button" title="G+"></a> </div> </div> <div class="clear-both"></div> <div class="menu"> <div class="tags"> <a href='/'>Главная</a><a href='/tag/Yii2/' class='selected'>Yii2</a><a href='/tag/PHP/'>PHP</a><a href='/tag/Books/'>Книги</a><a href='/tag/Learning/'>Обучение</a><a href='/tag/VirtualBox/'>VirtualBox</a><a href='/tag/Vagrant/'>Vagrant</a><a href='/tag/Cron/'>Cron</a><a href='/tag/Bash/'>Bash</a><a href='/tag/Others/'>Прочее</a> </div> <div class="lang-switcher"> <span>ru</span><a href='/en/'>en</a> </div> </div> <div class="clear-both"></div> <div class="contents"> <div class="article"> <h1>Yii2 - Отображение флеш (пользовательских) сообщений на сайте</h1> <div class="meta"> <div> <span class="flaticon-calendar-with-spring-binder-and-date-blocks"></span> 2016-08-10 </div> <div> <span class="flaticon-commerce"></span> <a href='/tag/Yii2/'>Yii2</a> </div> <div class="comments-number"> <span class="flaticon-comment-white-oval-bubble"></span> <a href="#comments" data-disqus-url="http://atoumus.github.io/yii2-flash-messages.html"></a> </div> </div> <div class="clear-both"></div> <div class="text"><p> <img src="/images/ru/articles/2016-08-10-yii2-flash-messages/result.png" alt="Yii2 - отображение флеш сообщений на сайте" align="left" style="margin: 0 20px 15px 0;" class="no-borders" /> Как отображать простейшие пользовательские уведомления на сайте с использованием фреймворка Yii2. </p>   <h2>Немного теории</h2> <p>Флеш сообщения в данном случае - это уведомления отображаемые пользователю при каких либо событиях.</p> <p>В Yii2 уже встроен механизм для работы с флеш сообщениями. Работает он по такому принципу:</p> <ol> <li>С помощью метода <code>\Yii::$app-&gt;session-&gt;addFlash()</code> добавляем сообщение в сессию.</li> <li>Сообщение в сессии хранится до тех пор пока оно оттуда не будет извлечено методом <code>Yii::$app-&gt;session-&gt;getAllFlashes()</code>.</li> <li>Как только сообщение извлечено, оно удаляется из сессии.</li> </ol> <h2>Реализация флеш сообщений</h2> <p>Далее, в качестве кодовой базы будет использован basic шаблон приложения предоставляемый Yii2. Как установить basic шаблон приложения описано в <a target="_blank" href="/yii2-basic-advanced.html">этой статье</a>.</p> <p>Теперь реализуем флеш сообщения на практике. В данном примере рассматриваются простейшие пользовательские уведомления, без каких либо анимаций и пр. Эти уведомления будут просто отображаться в верхней части сайта перед выводом остального контента.</p> <ol> <li> <p>Сначала создадим вспомогательный скрипт представления, в котором разместим код выводящий флеш сообщения. Для этого необходимо создать файл <code>\views\layouts\main\flashes.php</code> со следующим содержанием:</p> <pre class="line-numbers"><code class="language-php">&lt;?php foreach(Yii::$app-&gt;session-&gt;getAllFlashes() as $type =&gt; $messages): ?&gt;
&lt;?php foreach($messages as $message): ?&gt;
    &lt;div class="alert alert-&lt;?= $type ?&gt;" role="alert"&gt;&lt;?= $message ?&gt;&lt;/div&gt;
&lt;?php endforeach ?&gt;
&lt;?php endforeach ?&gt;</code></pre> </li> <li>Далее необходимо подключить только что созданное представление <code>flashes.php</code> в шаблон <code>\views\layouts\main.php</code>:</li> </ol> <p style="text-align: center;"><img src="/images/ru/articles/2016-08-10-yii2-flash-messages/1.png" alt="Yii2 - отображение флеш сообщений на сайте" /></p> <ol start="3"> <li>Теперь можно проверить как работают флеш сообщения, для этого в контроллере <code>\controllers\SiteController.php</code> добавляем следующие строки кода:</li> </ol> <p style="text-align: center;"><img src="/images/ru/articles/2016-08-10-yii2-flash-messages/2.png" alt="Yii2 - отображение флеш сообщений на сайте" /></p> <ol start="4"> <li>Обновляем страницу в браузере и видим результат:</li> </ol> <p style="text-align: center;"><img src="/images/ru/articles/2016-08-10-yii2-flash-messages/result.png" alt="Yii2 - отображение флеш сообщений на сайте" /></p> <h2>Заключение</h2> <p>Вообще это немного не полная реализация флеш сообщений. Потому что сейчас они отображаются при каждом обновлении главной страницы. В реальных приложениях флеш сообщения отображаются только после каких либо действий, и далее пропадают. Например, пользователю можно отобразить сообщение после регистрации о том, что ему необходимо подтвердить свой e-mail адрес, это сообщение достаточно отобразить один раз после чего оно должно исчезнуть. </p></div> <div class="related"> <h2>Читайте также</h2> <a href="/yii2-swiftmailer.html" target="_blank" >Yii2 - Отправка писем с помощью Swiftmailer</a> <a href="/yii2-i18n.html" target="_blank" >Yii2 - Интернационализация проекта (мультиязычность)</a> <a href="/yii2-basic-advanced.html" target="_blank" >Yii2 - Установка basic и advanced шаблонов приложения через Composer</a> <a href="/book-web-dev-yii2.html" target="_blank" >Книги - Разработка веб-приложений в Yii 2 (Марк Сафронов)</a> </div> <div class="share">Поделится: <script type="text/javascript">(function () { if (window.pluso) if (typeof window.pluso.start == "function") return; if (window.ifpluso == undefined) { window.ifpluso = 1; var d = document, s = d.createElement('script'), g = 'getElementsByTagName'; s.type = 'text/javascript'; s.charset = 'UTF-8'; s.async = true; s.src = ('https:' == window.location.protocol ? 'https' : 'http') + '://share.pluso.ru/pluso-like.js'; var h = d[g]('body')[0]; h.appendChild(s); } })();</script> <div class="pluso" data-background="transparent" data-options="small,round,line,horizontal,counter,theme=04" data-services="vkontakte,odnoklassniki,facebook,twitter,google,moimir,email,print"></div></div>   <div class="comments"> <a name="comments"></a> <div id="disqus_thread"></div> <script> var disqus_config = function () { this.page.url = "http://atoumus.github.io/yii2-flash-messages.html"; this.page.identifier = "yii2-flash-messages"; this.language = "ru"; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://atoumus.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </div> </div> <div class="footer"> <div class="left"> <div class="social"> <a href="#" class="icon search-toggle flaticon-magnifier" title="Поиск"></a> <a href="/atom.xml" target="_blank" class="icon flaticon-rss-feed-button" title="Atom лента"></a> <a href="https://twitter.com/atoumus/" target="_blank" class="icon flaticon-twitter-logo-silhouette" title="Twitter"></a> <a href="https://plus.google.com/u/0/116624784918762784912" target="_blank" class="icon flaticon-google-plus-logo-button" title="G+"></a> </div> <div class="author-email"> <a data-email-array='{"5":"u","13":".","16":"m","3":"u","10":"a","8":"g","2":"o","1":"t","6":"s","7":"@","9":"m","11":"i","0":"a","12":"l","14":"c","15":"o","4":"m"}' href="#"></a> </div> <div class="donate"> <a href="http://yasobe.ru/na/atoumus_blog" target="_blank">Поддержать финансово</a> </div> </div> <div class="right"> <div>  <script type="text/javascript"> document.write("<a href='//www.liveinternet.ru/click' "+ "target=_blank><img src='//counter.yadro.ru/hit?t25.5;r"+ escape(document.referrer)+((typeof(screen)=="undefined")?"": ";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth? screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+ ";"+Math.random()+ "' alt='' title='LiveInternet: показано число посетителей за"+ " сегодня' "+ "border='0' width='88' height='15'><\/a>") </script>  </div> <div> Atoumus Blog &copy; 2013 - 2018 </div> <div> Копирование и цитирование с обязательным указанием URL ссылки на оригинал страницы </div> </div> </div> <div class="clear-both"></div> </div> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script> <script type="text/javascript" src="/js/libs/prism.js"></script> <script type="text/javascript" src="/js/common.js"></script> </body> </html>